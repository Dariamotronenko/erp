{% extends 'supply_chain/base.html' %}

{% block title %}–î–µ—Ç–∞–ª–∏ –î–æ–≥–æ–≤–æ—Ä–∞: {{ –¥–æ–≥–æ–≤–æ—Ä.–Ω–æ–º–µ—Ä }}{% endblock %}

{% block content %}
    <div class="detail-header">
        <h1>–î–æ–≥–æ–≤–æ—Ä <span class="highlight-number">‚Ññ{{ –¥–æ–≥–æ–≤–æ—Ä.–Ω–æ–º–µ—Ä }}</span></h1>
        <p class="status-badge status-{{ –¥–æ–≥–æ–≤–æ—Ä.—Å—Ç–∞—Ç—É—Å|lower }}">{{ –¥–æ–≥–æ–≤–æ—Ä.—Å—Ç–∞—Ç—É—Å }}</p>
    </div>

    <div class="detail-container">
        <div class="detail-card">
            <div class="card-header">
                <h2>–û—Å–Ω–æ–≤–Ω—ã–µ —Ä–µ–∫–≤–∏–∑–∏—Ç—ã</h2>
                <div class="card-actions">
                    <a href="{% url '–¥–æ–≥–æ–≤–æ—Ä_update' –¥–æ–≥–æ–≤–æ—Ä.pk %}" class="action-btn edit-btn">
                        <span class="btn-icon">‚úèÔ∏è</span> –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
                    </a>
                    <a href="{% url '–¥–æ–≥–æ–≤–æ—Ä_delete' –¥–æ–≥–æ–≤–æ—Ä.pk %}" class="action-btn delete-btn">
                        <span class="btn-icon">üóëÔ∏è</span> –£–¥–∞–ª–∏—Ç—å
                    </a>
                </div>
            </div>
            
            <div class="card-body">
                <div class="info-grid">
                    <div class="info-item">
                        <span class="info-label">–ù–æ–º–µ—Ä –¥–æ–≥–æ–≤–æ—Ä–∞:</span>
                        <span class="info-value">{{ –¥–æ–≥–æ–≤–æ—Ä.–Ω–æ–º–µ—Ä }}</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">–î–∞—Ç–∞ –∑–∞–∫–ª—é—á–µ–Ω–∏—è:</span>
                        <span class="info-value">{{ –¥–æ–≥–æ–≤–æ—Ä.–¥–∞—Ç–∞_–∑–∞–∫–ª—é—á–µ–Ω–∏—è|date:"d.m.Y" }}</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">–ü–æ—Å—Ç–∞–≤—â–∏–∫:</span>
                        <span class="info-value">{{ –¥–æ–≥–æ–≤–æ—Ä.–ø–æ—Å—Ç–∞–≤—â–∏–∫ }}</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">–°—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è:</span>
                        <span class="info-value">{{ –¥–æ–≥–æ–≤–æ—Ä.—Å—Ä–æ–∫_–¥–µ–π—Å—Ç–≤–∏—è|date:"d.m.Y" }}</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">–£—Å–ª–æ–≤–∏—è –æ–ø–ª–∞—Ç—ã:</span>
                        <span class="info-value">{{ –¥–æ–≥–æ–≤–æ—Ä.—É—Å–ª–æ–≤–∏—è_–æ–ø–ª–∞—Ç—ã }}</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">–£—Å–ª–æ–≤–∏—è –ø–æ—Å—Ç–∞–≤–∫–∏:</span>
                        <span class="info-value">{{ –¥–æ–≥–æ–≤–æ—Ä.—É—Å–ª–æ–≤–∏—è_–ø–æ—Å—Ç–∞–≤–∫–∏ }}</span>
                    </div>
                    <div class="info-item full-width">
                        <span class="info-label">–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π:</span>
                        <span class="info-value">{{ –¥–æ–≥–æ–≤–æ—Ä.–∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π|default:"-" }}</span>
                    </div>
                </div>

                <!-- –ë–ª–æ–∫ —Å –ø—Ä–∏–∫—Ä–µ–ø–ª–µ–Ω–Ω—ã–º–∏ —Ñ–∞–π–ª–∞–º–∏ -->
                {% if –¥–æ–≥–æ–≤–æ—Ä.—Ñ–∞–π–ª—ã.all %}
                <div class="attachments-section">
                    <h3>–ü—Ä–∏–∫—Ä–µ–ø–ª–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã</h3>
                    <ul class="attachments-list">
                        {% for —Ñ–∞–π–ª in –¥–æ–≥–æ–≤–æ—Ä.—Ñ–∞–π–ª—ã.all %}
                        <li>
                            <a href="{{ —Ñ–∞–π–ª.—Ñ–∞–π–ª.url }}" target="_blank" class="file-link">
                                <span class="file-icon">üìÑ</span> {{ —Ñ–∞–π–ª.–Ω–∞–∑–≤–∞–Ω–∏–µ }}
                            </a>
                        </li>
                        {% endfor %}
                    </ul>
                </div>
                {% endif %}
            </div>
            
            <div class="card-footer">
                <a href="{% url '–¥–æ–≥–æ–≤–æ—Ä_list' %}" class="back-btn">
                    <span class="btn-icon">‚Üê</span> –í–µ—Ä–Ω—É—Ç—å—Å—è –∫ —Å–ø–∏—Å–∫—É
                </a>
            </div>
        </div>

        <!-- –ë–ª–æ–∫ –∏—Å—Ç–æ—Ä–∏–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–π -->
        <div class="history-section">
            <h2>–ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π</h2>
            <div class="history-timeline">
                {% for –∑–∞–ø–∏—Å—å in –¥–æ–≥–æ–≤–æ—Ä.history.all %}
                <div class="history-item">
                    <div class="history-date">{{ –∑–∞–ø–∏—Å—å.history_date|date:"d.m.Y H:i" }}</div>
                    <div class="history-user">{{ –∑–∞–ø–∏—Å—å.history_user.get_full_name|default:–∑–∞–ø–∏—Å—å.history_user.username }}</div>
                    <div class="history-change">
                        {% if –∑–∞–ø–∏—Å—å.history_type == '+' %}–°–æ–∑–¥–∞–Ω{% endif %}
                        {% if –∑–∞–ø–∏—Å—å.history_type == '~' %}–ò–∑–º–µ–Ω–µ–Ω{% endif %}
                        {% if –∑–∞–ø–∏—Å—å.history_type == '-' %}–£–¥–∞–ª–µ–Ω{% endif %}
                    </div>
                </div>
                {% empty %}
                <p class="no-history">–ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç</p>
                {% endfor %}
            </div>
        </div>
    </div>

    <!-- –°—Ç–∏–ª–∏ –¥–ª—è —ç—Ç–æ–≥–æ —à–∞–±–ª–æ–Ω–∞ -->
    <style>
        .highlight-number {
            color: #2c3e50;
            font-weight: 700;
        }
        
        .status-badge {
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 14px;
            font-weight: 600;
        }
        
        .status-active { background-color: #d4edda; color: #155724; }
        .status-draft { background-color: #fff3cd; color: #856404; }
        .status-archived { background-color: #f8d7da; color: #721c24; }
        
        .info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 15px;
        }
        
        .info-item {
            margin-bottom: 10px;
        }
        
        .info-label {
            font-weight: 600;
            color: #6c757d;
        }
        
        .info-value {
            display: block;
            margin-top: 5px;
            padding: 8px;
            background: #f8f9fa;
            border-radius: 4px;
        }
        
        .full-width {
            grid-column: 1 / -1;
        }
        
        .attachments-list {
            list-style: none;
            padding: 0;
        }
        
        .file-link {
            display: inline-block;
            padding: 8px 12px;
            background: #e9ecef;
            border-radius: 4px;
            margin-right: 10px;
            margin-bottom: 10px;
        }
        
        .history-timeline {
            border-left: 2px solid #dee2e6;
            padding-left: 20px;
        }
        
        .history-item {
            margin-bottom: 15px;
            position: relative;
            padding-left: 15px;
        }
        
        .history-item::before {
            content: "";
            position: absolute;
            left: -6px;
            top: 5px;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: #6c757d;
        }
    </style>
{% endblock %}